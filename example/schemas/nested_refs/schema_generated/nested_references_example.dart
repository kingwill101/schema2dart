// GENERATED CODE - DO NOT MODIFY BY HAND
// Source: example/schemas/nested_refs/schema.json
// Generated by json_schema2dart

import 'address.dart';
import 'manager.dart';
import 'person.dart';
import 'validation_error.dart';

/// Demonstrates $ref usage and nested definitions
class NestedReferencesExample {
  final Person? employee;
  final Manager? manager;
  final List<Address>? offices;

  const NestedReferencesExample({this.employee, this.manager, this.offices});

  factory NestedReferencesExample.fromJson(Map<String, dynamic> json) {
    final remaining = Map<String, dynamic>.from(json);
    final employee = json['employee'] == null
        ? null
        : Person.fromJson((json['employee'] as Map).cast<String, dynamic>());
    remaining.remove('employee');
    final manager = json['manager'] == null
        ? null
        : Manager.fromJson((json['manager'] as Map).cast<String, dynamic>());
    remaining.remove('manager');
    final offices = json['offices'] == null
        ? null
        : (json['offices'] as List)
              .map((e) => Address.fromJson((e as Map).cast<String, dynamic>()))
              .toList();
    remaining.remove('offices');
    return NestedReferencesExample(
      employee: employee,
      manager: manager,
      offices: offices,
    );
  }

  Map<String, dynamic> toJson() {
    final map = <String, dynamic>{};
    if (employee != null) map['employee'] = employee!.toJson();
    if (manager != null) map['manager'] = manager!.toJson();
    if (offices != null)
      map['offices'] = offices!.map((e) => e.toJson()).toList();
    return map;
  }

  void validate({String pointer = '', ValidationContext? context}) {
    final _ptr0 = appendJsonPointer(pointer, 'employee');
    final _value0 = employee;
    if (_value0 != null) {
      context?.markProperty(pointer, 'employee');
    }
    final _ptr1 = appendJsonPointer(pointer, 'manager');
    final _value1 = manager;
    if (_value1 != null) {
      context?.markProperty(pointer, 'manager');
      final _jsonp1 = _value1.toJson();
      final _constraintp1c0_0 = context == null ? null : ValidationContext();
      var _constraintp1m0_0 = false;
      try {
        final context = _constraintp1c0_0;
        final _constraintp1v0_0 = Person.fromJson(
          (_jsonp1 as Map).cast<String, dynamic>(),
        );
        _constraintp1m0_0 = true;
      } on ValidationError {
      } catch (_) {}
      final _constraintp1c0_1 = context == null ? null : ValidationContext();
      var _constraintp1m0_1 = false;
      try {
        final context = _constraintp1c0_1;
        final _constraintp1v0_1 = RootSchemaManager.fromJson(
          (_jsonp1 as Map).cast<String, dynamic>(),
        );
        _constraintp1m0_1 = true;
      } on ValidationError {
      } catch (_) {}
      final _constraintp1matches0 = <bool>[
        _constraintp1m0_0,
        _constraintp1m0_1,
      ];
      if (_constraintp1matches0.any((value) => !value)) {
        throwValidationError(
          _ptr1,
          'allOf',
          'Expected all subschemas in #/properties/manager/allOf to validate.',
        );
      }
      if (context != null && _constraintp1m0_0 && _constraintp1c0_0 != null) {
        context.mergeFrom(_constraintp1c0_0!);
      }
      if (context != null && _constraintp1m0_1 && _constraintp1c0_1 != null) {
        context.mergeFrom(_constraintp1c0_1!);
      }
    }
    final _ptr2 = appendJsonPointer(pointer, 'offices');
    final _value2 = offices;
    if (_value2 != null) {
      context?.markProperty(pointer, 'offices');
    }
  }
}
